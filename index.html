<!DOCTYPE html>
<html lang="pt-PT">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Gestão Completa de Stock e Utilizadores</title>
<style>
  /* Reset */
  *, *::before, *::after {
    box-sizing: border-box;
  }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0; padding: 0;
    background: #f5f7fa;
    color: #333;
  }
  header {
    background-color: #4a90e2;
    color: white;
    padding: 24px 16px;
    text-align: center;
    font-size: 28px;
    font-weight: 700;
    user-select: none;
  }
  nav {
    display: flex;
    justify-content: center;
    background-color: #3a78d8;
    flex-wrap: wrap;
  }
  nav button {
    background: transparent;
    border: none;
    color: white;
    padding: 16px 32px;
    font-size: 17px;
    cursor: pointer;
    transition: background-color 0.25s ease;
    border-radius: 8px 8px 0 0;
    user-select: none;
    margin: 0 4px;
  }
  nav button.active,
  nav button:hover {
    background-color: #2c5bb1;
  }
  main {
    max-width: 960px;
    margin: 28px auto;
    background: white;
    padding: 28px 32px;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgb(0 0 0 / 0.12);
  }
  h2 {
    margin-top: 0;
    color: #4a90e2;
    font-weight: 700;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
    font-size: 15px;
  }
  th, td {
    padding: 14px 18px;
    border: 1px solid #e1e8f0;
    text-align: left;
  }
  th {
    background-color: #f0f4fc;
    font-weight: 600;
  }
  tbody tr:nth-child(even) {
    background-color: #f9fbfe;
  }
  input, select {
    width: 100%;
    padding: 10px 14px;
    margin-top: 8px;
    margin-bottom: 18px;
    border-radius: 8px;
    border: 1px solid #cdd7e5;
    font-size: 16px;
    transition: border-color 0.2s ease;
  }
  input:focus, select:focus {
    outline: none;
    border-color: #4a90e2;
    box-shadow: 0 0 6px #a5c7f9;
  }
  label {
    font-weight: 600;
    font-size: 16px;
  }
  .form-group {
    margin-bottom: 14px;
  }
  button.action {
    background-color: #4a90e2;
    color: white;
    border: none;
    padding: 14px 28px;
    border-radius: 10px;
    font-size: 17px;
    cursor: pointer;
    transition: background-color 0.3s ease;
    user-select: none;
    margin-right: 12px;
  }
  button.action:hover {
    background-color: #3a78d8;
  }
  button.secondary {
    background-color: #6c757d;
  }
  button.secondary:hover {
    background-color: #5a6268;
  }
  .flex-row {
    display: flex;
    gap: 18px;
    flex-wrap: wrap;
  }
  .flex-1 {
    flex: 1;
  }
  .actions-cell button {
    margin-right: 8px;
    padding: 8px 16px;
    font-size: 14px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.3s ease;
  }
  .actions-cell button.edit {
    background-color: #198754;
    color: white;
  }
  .actions-cell button.edit:hover {
    background-color: #146c43;
  }
  .actions-cell button.delete {
    background-color: #dc3545;
    color: white;
  }
  .actions-cell button.delete:hover {
    background-color: #b02a37;
  }
  .message {
    padding: 14px 20px;
    margin-bottom: 20px;
    border-radius: 10px;
    font-weight: 600;
  }
  .message.success {
    background-color: #d1e7dd;
    color: #0f5132;
  }
  .message.error {
    background-color: #f8d7da;
    color: #842029;
  }
  /* Responsivo */
  @media (max-width: 700px) {
    nav {
      flex-direction: column;
    }
    nav button {
      border-radius: 0;
      margin: 0;
      padding: 14px 0;
      font-size: 16px;
    }
    main {
      margin: 15px;
      padding: 20px;
    }
    .flex-row {
      flex-direction: column;
    }
  }
</style>
</head>
<body>

<header>Gestão Completa de Stock e Utilizadores</header>

<nav>
  <button id="nav-stock" class="active" aria-controls="section-stock" aria-selected="true" role="tab">Stock</button>
  <button id="nav-users" aria-controls="section-users" aria-selected="false" role="tab">Utilizadores</button>
  <button id="nav-movements" aria-controls="section-movements" aria-selected="false" role="tab">Movimentações</button>
</nav>

<main>
  <section id="section-stock" role="tabpanel" aria-labelledby="nav-stock">
    <h2>Stock de Produtos</h2>
    <div id="stock-message"></div>
    <table id="table-stock" aria-describedby="stock-desc" role="grid">
      <caption id="stock-desc" class="sr-only">Lista de produtos em stock</caption>
      <thead>
        <tr>
          <th scope="col">ID Produto</th>
          <th scope="col">Nome</th>
          <th scope="col">Quantidade</th>
          <th scope="col">Preço Unitário (€)</th>
          <th scope="col">Categoria</th>
          <th scope="col">Ações</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <h3>Adicionar / Editar Produto</h3>
    <form id="form-stock" novalidate>
      <input type="hidden" id="stock-edit-id" />
      <div class="flex-row">
        <div class="flex-1 form-group">
          <label for="product-id">ID Produto*</label>
          <input type="text" id="product-id" required aria-required="true" placeholder="Ex: P001" />
        </div>
        <div class="flex-1 form-group">
          <label for="product-name">Nome*</label>
          <input type="text" id="product-name" required aria-required="true" placeholder="Ex: Caneta Azul" />
        </div>
      </div>
      <div class="flex-row">
        <div class="flex-1 form-group">
          <label for="product-quantity">Quantidade*</label>
          <input type="number" id="product-quantity" min="0" step="1" required aria-required="true" placeholder="Ex: 100" />
        </div>
        <div class="flex-1 form-group">
          <label for="product-price">Preço Unitário (€)*</label>
          <input type="number" id="product-price" min="0" step="0.01" required aria-required="true" placeholder="Ex: 1.50" />
        </div>
      </div>
      <div class="form-group">
        <label for="product-category">Categoria</label>
        <input type="text" id="product-category" placeholder="Ex: Material de Escritório" />
      </div>
      <button type="submit" class="action">Guardar Produto</button>
      <button type="button" class="secondary" id="btn-stock-clear">Limpar</button>
    </form>
  </section>

  <section id="section-users" role="tabpanel" aria-labelledby="nav-users" hidden>
    <h2>Gestão de Utilizadores</h2>
    <div id="users-message"></div>
    <table id="table-users" aria-describedby="users-desc" role="grid">
      <caption id="users-desc" class="sr-only">Lista de utilizadores</caption>
      <thead>
        <tr>
          <th scope="col">ID Utilizador</th>
          <th scope="col">Nome</th>
          <th scope="col">Função</th>
          <th scope="col">Permissão</th>
          <th scope="col">Ações</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <h3>Adicionar / Editar Utilizador</h3>
    <form id="form-users" novalidate>
      <input type="hidden" id="user-edit-id" />
      <div class="flex-row">
        <div class="flex-1 form-group">
          <label for="user-id">ID Utilizador*</label>
          <input type="text" id="user-id" required aria-required="true" placeholder="Ex: U001" />
        </div>
        <div class="flex-1 form-group">
          <label for="user-name">Nome*</label>
          <input type="text" id="user-name" required aria-required="true" placeholder="Ex: João Silva" />
        </div>
      </div>
      <div class="flex-row">
        <div class="flex-1 form-group">
          <label for="user-role">Função</label>
          <input type="text" id="user-role" placeholder="Ex: Armazenista" />
        </div>
        <div class="flex-1 form-group">
          <label for="user-permission">Permissão*</label>
          <select id="user-permission" required aria-required="true">
            <option value="" disabled selected>Selecione uma permissão</option>
            <option value="Administrador">Administrador</option>
            <option value="Utilizador">Utilizador</option>
          </select>
        </div>
      </div>
      <button type="submit" class="action">Guardar Utilizador</button>
      <button type="button" class="secondary" id="btn-users-clear">Limpar</button>
    </form>
  </section>

  <section id="section-movements" role="tabpanel" aria-labelledby="nav-movements" hidden>
    <h2>Registo de Movimentações</h2>
    <div id="movements-message"></div>
    <table id="table-movements" aria-describedby="movements-desc" role="grid">
      <caption id="movements-desc" class="sr-only">Lista de movimentações de stock</caption>
      <thead>
        <tr>
          <th scope="col">Data / Hora</th>
          <th scope="col">ID Produto</th>
          <th scope="col">Nome Produto</th>
          <th scope="col">Tipo de Movimento</th>
          <th scope="col">Quantidade</th>
          <th scope="col">ID Utilizador</th>
          <th scope="col">Nome Utilizador</th>
          <th scope="col">Observações</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <h3>Adicionar Movimentação</h3>
    <form id="form-movements" novalidate>
      <div class="flex-row">
        <div class="flex-1 form-group">
          <label for="movement-product">Produto*</label>
          <select id="movement-product" required aria-required="true">
            <option value="" disabled selected>Selecione um produto</option>
          </select>
        </div>
        <div class="flex-1 form-group">
          <label for="movement-user">Utilizador*</label>
          <select id="movement-user" required aria-required="true">
            <option value="" disabled selected>Selecione um utilizador</option>
          </select>
        </div>
      </div>
      <div class="flex-row">
        <div class="flex-1 form-group">
          <label for="movement-type">Tipo de Movimento*</label>
          <select id="movement-type" required aria-required="true">
            <option value="" disabled selected>Entrada ou Saída</option>
            <option value="Entrada">Entrada</option>
            <option value="Saída">Saída</option>
          </select>
        </div>
        <div class="flex-1 form-group">
          <label for="movement-quantity">Quantidade*</label>
          <input type="number" id="movement-quantity" min="1" step="1" required aria-required="true" placeholder="Ex: 10" />
        </div>
      </div>
      <div class="form-group">
        <label for="movement-notes">Observações</label>
        <input type="text" id="movement-notes" placeholder="Ex: Reposição de stock" />
      </div>
      <button type="submit" class="action">Registar Movimento</button>
      <button type="button" class="secondary" id="btn-movements-clear">Limpar</button>
    </form>
  </section>
</main>

<script>
  // Utilitário para mostrar mensagens (success ou error)
  function showMessage(containerId, message, type='success') {
    const container = document.getElementById(containerId);
    container.innerHTML = '<div class="message ' + type + '">' + message + '</div>';
    setTimeout(() => container.innerHTML = '', 3500);
  }

  // Dados armazenados no localStorage
  const STORAGE_KEYS = {
    PRODUCTS: 'app_products',
    USERS: 'app_users',
    MOVEMENTS: 'app_movements',
  };

  // Estado na memória (carregado do localStorage)
  let products = [];
  let users = [];
  let movements = [];

  // Inicializar a app
  function init() {
    loadData();
    renderTables();
    setupNav();
    setupForms();
  }

  // Carregar dados do localStorage
  function loadData() {
    products = JSON.parse(localStorage.getItem(STORAGE_KEYS.PRODUCTS)) || [];
    users = JSON.parse(localStorage.getItem(STORAGE_KEYS.USERS)) || [];
    movements = JSON.parse(localStorage.getItem(STORAGE_KEYS.MOVEMENTS)) || [];
  }

  // Guardar dados no localStorage
  function saveData() {
    localStorage.setItem(STORAGE_KEYS.PRODUCTS, JSON.stringify(products));
    localStorage.setItem(STORAGE_KEYS.USERS, JSON.stringify(users));
    localStorage.setItem(STORAGE_KEYS.MOVEMENTS, JSON.stringify(movements));
  }

  // Renderizar tabela de produtos
  function renderProducts() {
    const tbody = document.querySelector('#table-stock tbody');
    tbody.innerHTML = '';
    if(products.length === 0) {
      tbody.innerHTML = '<tr><td colspan="6" style="text-align:center; color:#777;">Nenhum produto registado.</td></tr>';
      return;
    }
    products.forEach(prod => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${prod.id}</td>
        <td>${prod.name}</td>
        <td>${prod.quantity}</td>
        <td>${prod.price.toFixed(2)}</td>
        <td>${prod.category || ''}</td>
        <td class="actions-cell">
          <button class="edit" title="Editar Produto" onclick="editProduct('${prod.id}')">Editar</button>
          <button class="delete" title="Eliminar Produto" onclick="deleteProduct('${prod.id}')">Eliminar</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
  }

  // Renderizar tabela de utilizadores
  function renderUsers() {
    const tbody = document.querySelector('#table-users tbody');
    tbody.innerHTML = '';
    if(users.length === 0) {
      tbody.innerHTML = '<tr><td colspan="5" style="text-align:center; color:#777;">Nenhum utilizador registado.</td></tr>';
      return;
    }
    users.forEach(user => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${user.id}</td>
        <td>${user.name}</td>
        <td>${user.role || ''}</td>
        <td>${user.permission}</td>
        <td class="actions-cell">
          <button class="edit" title="Editar Utilizador" onclick="editUser('${user.id}')">Editar</button>
          <button class="delete" title="Eliminar Utilizador" onclick="deleteUser('${user.id}')">Eliminar</button>
        </td>
      `;
      tbody.appendChild(tr);
    });
  }

  // Renderizar tabela de movimentações
  function renderMovements() {
    const tbody = document.querySelector('#table-movements tbody');
    tbody.innerHTML = '';
    if(movements.length === 0) {
      tbody.innerHTML = '<tr><td colspan="8" style="text-align:center; color:#777;">Nenhuma movimentação registada.</td></tr>';
      return;
    }
    movements.forEach(mov => {
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${new Date(mov.date).toLocaleString('pt-PT')}</td>
        <td>${mov.productId}</td>
        <td>${mov.productName}</td>
        <td>${mov.type}</td>
        <td>${mov.quantity}</td>
        <td>${mov.userId}</td>
        <td>${mov.userName}</td>
        <td>${mov.notes || ''}</td>
      `;
      tbody.appendChild(tr);
    });
  }

  // Renderizar todas as tabelas e selects
  function renderTables() {
    renderProducts();
    renderUsers();
    renderMovements();
    populateSelects();
  }

  // Preencher selects de produtos e utilizadores no formulário de movimentações
  function populateSelects() {
    const productSelect = document.getElementById('movement-product');
    const userSelect = document.getElementById('movement-user');

    // Limpar opções anteriores
    productSelect.innerHTML = '<option value="" disabled selected>Selecione um produto</option>';
    userSelect.innerHTML = '<option value="" disabled selected>Selecione um utilizador</option>';

    products.forEach(prod => {
      const option = document.createElement('option');
      option.value = prod.id;
      option.textContent = `${prod.id} - ${prod.name}`;
      productSelect.appendChild(option);
    });

    users.forEach(user => {
      const option = document.createElement('option');
      option.value = user.id;
      option.textContent = `${user.id} - ${user.name}`;
      userSelect.appendChild(option);
    });
  }

  // Navegação entre secções
  function setupNav() {
    const navButtons = document.querySelectorAll('nav button');
    navButtons.forEach(button => {
      button.addEventListener('click', () => {
        navButtons.forEach(btn => {
          btn.classList.remove('active');
          btn.setAttribute('aria-selected', 'false');
          document.getElementById(btn.getAttribute('aria-controls')).hidden = true;
        });
        button.classList.add('active');
        button.setAttribute('aria-selected', 'true');
        document.getElementById(button.getAttribute('aria-controls')).hidden = false;
      });
    });
  }

  // Limpar formulário de stock
  function clearStockForm() {
    document.getElementById('form-stock').reset();
    document.getElementById('stock-edit-id').value = '';
  }

  // Limpar formulário de utilizadores
  function clearUsersForm() {
    document.getElementById('form-users').reset();
    document.getElementById('user-edit-id').value = '';
  }

  // Limpar formulário de movimentações
  function clearMovementsForm() {
    document.getElementById('form-movements').reset();
  }

  // Editar produto
  function editProduct(id) {
    const prod = products.find(p => p.id === id);
    if(!prod) return;
    document.getElementById('stock-edit-id').value = prod.id;
    document.getElementById('product-id').value = prod.id;
    document.getElementById('product-name').value = prod.name;
    document.getElementById('product-quantity').value = prod.quantity;
    document.getElementById('product-price').value = prod.price;
    document.getElementById('product-category').value = prod.category || '';
    window.scrollTo({top: 0, behavior: 'smooth'});
  }

  // Editar utilizador
  function editUser(id) {
    const user = users.find(u => u.id === id);
    if(!user) return;
    document.getElementById('user-edit-id').value = user.id;
    document.getElementById('user-id').value = user.id;
    document.getElementById('user-name').value = user.name;
    document.getElementById('user-role').value = user.role || '';
    document.getElementById('user-permission').value = user.permission;
    window.scrollTo({top: 0, behavior: 'smooth'});
  }

  // Eliminar produto
  function deleteProduct(id) {
    if(!confirm('Tem a certeza que pretende eliminar este produto?')) return;
    // Verificar se o produto está referenciado em movimentações
    const usedInMov = movements.find(mov => mov.productId === id);
    if(usedInMov) {
      alert('Não é possível eliminar o produto pois está associado a movimentações.');
      return;
    }
    products = products.filter(p => p.id !== id);
    saveData();
    renderProducts();
    populateSelects();
    showMessage('stock-message', 'Produto eliminado com sucesso.', 'success');
  }

  // Eliminar utilizador
  function deleteUser(id) {
    if(!confirm('Tem a certeza que pretende eliminar este utilizador?')) return;
    // Verificar se o utilizador está referenciado em movimentações
    const usedInMov = movements.find(mov => mov.userId === id);
    if(usedInMov) {
      alert('Não é possível eliminar o utilizador pois está associado a movimentações.');
      return;
    }
    users = users.filter(u => u.id !== id);
    saveData();
    renderUsers();
    populateSelects();
    showMessage('users-message', 'Utilizador eliminado com sucesso.', 'success');
  }

  // Guardar / Atualizar produto
  document.getElementById('form-stock').addEventListener('submit', function(e) {
    e.preventDefault();
    const editId = document.getElementById('stock-edit-id').value.trim();
    const id = document.getElementById('product-id').value.trim();
    const name = document.getElementById('product-name').value.trim();
    const quantityStr = document.getElementById('product-quantity').value.trim();
    const priceStr = document.getElementById('product-price').value.trim();
    const category = document.getElementById('product-category').value.trim();

    if(!id || !name || !quantityStr || !priceStr) {
      showMessage('stock-message', 'Por favor, preencha todos os campos obrigatórios.', 'error');
      return;
    }

    const quantity = Number(quantityStr);
    const price = Number(priceStr);
    if(isNaN(quantity) || quantity < 0) {
      showMessage('stock-message', 'Quantidade inválida.', 'error');
      return;
    }
    if(isNaN(price) || price < 0) {
      showMessage('stock-message', 'Preço inválido.', 'error');
      return;
    }

    if(editId) {
      // Atualizar produto existente
      const prodIndex = products.findIndex(p => p.id === editId);
      if(prodIndex === -1) {
        showMessage('stock-message', 'Produto para editar não encontrado.', 'error');
        return;
      }
      // Se o ID for alterado, verificar duplicação
      if(editId !== id && products.some(p => p.id === id)) {
        showMessage('stock-message', 'Já existe um produto com este ID.', 'error');
        return;
      }
      products[prodIndex] = { id, name, quantity, price, category };
      showMessage('stock-message', 'Produto atualizado com sucesso.', 'success');
    } else {
      // Verificar duplicação ID novo produto
      if(products.some(p => p.id === id)) {
        showMessage('stock-message', 'Já existe um produto com este ID.', 'error');
        return;
      }
      products.push({ id, name, quantity, price, category });
      showMessage('stock-message', 'Produto adicionado com sucesso.', 'success');
    }

    saveData();
    renderProducts();
    populateSelects();
    clearStockForm();
  });

  document.getElementById('btn-stock-clear').addEventListener('click', clearStockForm);

  // Guardar / Atualizar utilizador
  document.getElementById('form-users').addEventListener('submit', function(e) {
    e.preventDefault();
    const editId = document.getElementById('user-edit-id').value.trim();
    const id = document.getElementById('user-id').value.trim();
    const name = document.getElementById('user-name').value.trim();
    const role = document.getElementById('user-role').value.trim();
    const permission = document.getElementById('user-permission').value;

    if(!id || !name || !permission) {
      showMessage('users-message', 'Por favor, preencha todos os campos obrigatórios.', 'error');
      return;
    }

    if(editId) {
      const userIndex = users.findIndex(u => u.id === editId);
      if(userIndex === -1) {
        showMessage('users-message', 'Utilizador para editar não encontrado.', 'error');
        return;
      }
      if(editId !== id && users.some(u => u.id === id)) {
        showMessage('users-message', 'Já existe um utilizador com este ID.', 'error');
        return;
      }
      users[userIndex] = { id, name, role, permission };
      showMessage('users-message', 'Utilizador atualizado com sucesso.', 'success');
    } else {
      if(users.some(u => u.id === id)) {
        showMessage('users-message', 'Já existe um utilizador com este ID.', 'error');
        return;
      }
      users.push({ id, name, role, permission });
      showMessage('users-message', 'Utilizador adicionado com sucesso.', 'success');
    }

    saveData();
    renderUsers();
    populateSelects();
    clearUsersForm();
  });

  document.getElementById('btn-users-clear').addEventListener('click', clearUsersForm);

  // Registar movimentação
  document.getElementById('form-movements').addEventListener('submit', function(e) {
    e.preventDefault();

    const productId = document.getElementById('movement-product').value;
    const userId = document.getElementById('movement-user').value;
    const type = document.getElementById('movement-type').value;
    const quantityStr = document.getElementById('movement-quantity').value.trim();
    const notes = document.getElementById('movement-notes').value.trim();

    if(!productId || !userId || !type || !quantityStr) {
      showMessage('movements-message', 'Por favor, preencha todos os campos obrigatórios.', 'error');
      return;
    }

    const quantity = Number(quantityStr);
    if(isNaN(quantity) || quantity <= 0) {
      showMessage('movements-message', 'Quantidade inválida.', 'error');
      return;
    }

    // Encontrar produto e utilizador
    const product = products.find(p => p.id === productId);
    const user = users.find(u => u.id === userId);
    if(!product || !user) {
      showMessage('movements-message', 'Produto ou utilizador não encontrado.', 'error');
      return;
    }

    // Verificar stock para saída
    if(type === 'saida' && product.quantity < quantity) {
      showMessage('movements-message', 'Quantidade insuficiente em stock.', 'error');
      return;
    }

    // Atualizar stock
    if(type === 'entrada') {
      product.quantity += quantity;
    } else {
      product.quantity -= quantity;
    }

    // Registar movimentação
    movements.push({
      date: new Date().toISOString(),
      productId,
      productName: product.name,
      type,
      quantity,
      userId,
      userName: user.name,
      notes
    });

    saveData();
    renderTables();
    clearMovementsForm();
    showMessage('movements-message', 'Movimentação registada com sucesso.', 'success');
  });

  document.getElementById('btn-movements-clear').addEventListener('click', clearMovementsForm);

  // Inicialização
  document.addEventListener('DOMContentLoaded', init);
</script>

<style>
  /* Reset básico */
  * {
    box-sizing: border-box;
  }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f7f9fc;
    margin: 0;
    padding: 20px;
    color: #333;
  }
  h1 {
    text-align: center;
    margin-bottom: 20px;
    color: #222;
  }
  nav {
    display: flex;
    justify-content: center;
    margin-bottom: 25px;
    gap: 15px;
  }
  nav button {
    background: #0078d7;
    border: none;
    padding: 10px 20px;
    color: #fff;
    font-weight: 600;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  nav button:hover, nav button.active {
    background: #005ea2;
  }
  section {
    max-width: 960px;
    margin: 0 auto;
    background: #fff;
    border-radius: 8px;
    padding: 25px 30px;
    box-shadow: 0 2px 10px rgb(0 0 0 / 0.1);
  }
  form {
    display: grid;
    gap: 12px;
    margin-bottom: 20px;
  }
  label {
    font-weight: 600;
  }
  input[type=text], input[type=number], select, textarea {
    width: 100%;
    padding: 8px 10px;
    font-size: 15px;
    border: 1.8px solid #ccc;
    border-radius: 6px;
    transition: border-color 0.3s ease;
  }
  input[type=text]:focus, input[type=number]:focus, select:focus, textarea:focus {
    border-color: #0078d7;
    outline: none;
  }
  textarea {
    resize: vertical;
    min-height: 60px;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 8px;
  }
  th, td {
    border: 1.3px solid #ddd;
    padding: 10px 12px;
    text-align: left;
  }
  th {
    background-color: #f0f0f0;
    font-weight: 700;
  }
  .actions-cell button {
    margin-right: 8px;
    padding: 5px 10px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    color: #fff;
  }
  .actions-cell button.edit {
    background-color: #28a745;
  }
  .actions-cell button.delete {
    background-color: #dc3545;
  }
  .actions-cell button.edit:hover {
    background-color: #218838;
  }
  .actions-cell button.delete:hover {
    background-color: #c82333;
  }
  .message {
    padding: 10px;
    margin-bottom: 15px;
    border-radius: 6px;
    font-weight: 600;
  }
  .success {
    background-color: #d4edda;
    color: #155724;
    border: 1.5px solid #c3e6cb;
  }
  .error {
    background-color: #f8d7da;
    color: #721c24;
    border: 1.5px solid #f5c6cb;
  }
</style>

<!-- Estrutura HTML para a app -->
<main>
  <h1>Gestão de Stock</h1>

  <nav role="tablist" aria-label="Navegação da aplicação">
    <button role="tab" aria-controls="section-stock" aria-selected="true" class="active">Stock</button>
    <button role="tab" aria-controls="section-users" aria-selected="false">Utilizadores</button>
    <button role="tab" aria-controls="section-movements" aria-selected="false">Movimentações</button>
  </nav>

  <section id="section-stock" role="tabpanel">
    <form id="form-stock" aria-label="Formulário de produtos">
      <input type="hidden" id="stock-edit-id">
      <label for="product-id">ID do Produto *</label>
      <input type="text" id="product-id" maxlength="15" required aria-required="true">
      <label for="product-name">Nome do Produto *</label>
      <input type="text" id="product-name" maxlength="50" required aria-required="true">
      <label for="product-quantity">Quantidade *</label>
      <input type="number" id="product-quantity" min="0" required aria-required="true">
      <label for="product-price">Preço (€) *</label>
      <input type="number" id="product-price" min="0" step="0.01" required aria-required="true">
      <label for="product-category">Categoria</label>
      <input type="text" id="product-category" maxlength="30">
      <div>
        <button type="submit">Guardar Produto</button>
        <button type="button" id="btn-stock-clear">Limpar</button>
      </div>
    </form>
    <div id="stock-message" aria-live="polite"></div>

    <table id="table-stock" aria-label="Tabela de produtos">
      <thead>
        <tr>
          <th>ID</th><th>Nome</th><th>Quantidade</th><th>Preço (€)</th><th>Categoria</th><th>Ações</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <section id="section-users" role="tabpanel" hidden>
    <form id="form-users" aria-label="Formulário de utilizadores">
      <input type="hidden" id="user-edit-id">
      <label for="user-id">ID do Utilizador *</label>
      <input type="text" id="user-id" maxlength="15" required aria-required="true">
      <label for="user-name">Nome do Utilizador *</label>
      <input type="text" id="user-name" maxlength="50" required aria-required="true">
      <label for="user-role">Função</label>
      <input type="text" id="user-role" maxlength="30">
      <label for="user-permission">Permissão *</label>
      <select id="user-permission" required aria-required="true">
        <option value="" disabled selected>Selecione a permissão</option>
        <option value="admin">Administrador</option>
        <option value="user">Utilizador</option>
      </select>
      <div>
        <button type="submit">Guardar Utilizador</button>
        <button type="button" id="btn-users-clear">Limpar</button>
      </div>
    </form>
    <div id="users-message" aria-live="polite"></div>

    <table id="table-users" aria-label="Tabela de utilizadores">
      <thead>
        <tr>
          <th>ID</th><th>Nome</th><th>Função</th><th>Permissão</th><th>Ações</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <section id="section-movements" role="tabpanel" hidden>
    <form id="form-movements" aria-label="Formulário de movimentações">
      <label for="movement-product">Produto *</label>
      <select id="movement-product" required aria-required="true"></select>
      <label for="movement-user">Utilizador *</label>
      <select id="movement-user" required aria-required="true"></select>
      <label for="movement-type">Tipo de Movimentação *</label>
      <select id="movement-type" required aria-required="true">
        <option value="" disabled selected>Selecione o tipo</option>
        <option value="entrada">Entrada</option>
        <option value="saida">Saída</option>
      </select>
      <label for="movement-quantity">Quantidade *</label>
      <input type="number" id="movement-quantity" min="1" required aria-required="true">
      <label for="movement-notes">Notas</label>
      <textarea id="movement-notes"></textarea>
      <div>
        <button type="submit">Registar Movimentação</button>
        <button type="button" id="btn-movements-clear">Limpar</button>
      </div>
    </form>
    <div id="movements-message" aria-live="polite"></div>

    <table id="table-movements" aria-label="Tabela de movimentações">
      <thead>
        <tr>
          <th>Data</th><th>ID Produto</th><th>Produto</th><th>Tipo</th><th>Quantidade</th><th>ID Utilizador</th><th>Utilizador</th><th>Notas</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>
</main>
